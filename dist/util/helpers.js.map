{"version":3,"sources":["../../src/util/helpers.js"],"names":["VIDEO","data","bestQuality","v","title","iurlmaxres","url_encoded_fmt_stream_map","url","type","caption_tracks","Array","isArray","n","i","length","src","Buffer","u","toString","lc","parse","adaptive_fmts","parseURLSTR","afv_ad_tag","caption_translation_languages","str","obj"],"mappings":"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","file":"helpers.js","sourcesContent":["import querystring from 'querystring';\nexport class VIDEO {\n  constructor(data){\n    this.data = querystring.parse(data);\n    if(this.data.adaptive_fmts)this.data.adaptive_fmts = this.parseURLSTR(this.data.adaptive_fmts);\n    if(this.data.url_encoded_fmt_stream_map)this.data.url_encoded_fmt_stream_map = this.parseURLSTR(this.data.url_encoded_fmt_stream_map);\n    if(this.data.afv_ad_tag)this.data.afv_ad_tag = this.parseURLSTR(this.data.afv_ad_tag);\n    if(this.data.caption_tracks)this.data.caption_tracks = this.parseURLSTR(this.data.caption_tracks);\n    if(this.data.caption_translation_languages)this.data.caption_translation_languages = this.parseURLSTR(this.data.caption_translation_languages);\n    // return this.data;\n  }\n  parseURLSTR(str){\n    let obj = querystring.parse(str);\n    return obj;\n  }\n  bestQuality = () => {\n    //add #t=[start_time][,end_time] to the media URL.\n    let v = `<!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <title>${this.data.title}</title>\n      </head>\n      <body>\n\n      <video controls autoplay style=\"width:100%\" poster=\"${this.data.iurlmaxres}\">\n      <source src=\"${this.data.url_encoded_fmt_stream_map.url[0]}\"\n              type='${this.data.url_encoded_fmt_stream_map.type[0]}'/>`;\n      // v += `<track kind=\"subtitles\" label=\"Italian\" srclang=\"it\" src=\"https://m.youtube.com/api/timedtext?sparams=asr_langs%2Ccaps%2Cv%2Cexpire&amp;signature=05ED52879297D56CE654812BAD0135D819C71391.7CB95227425238C954573B04A51310857D65E438&amp;asr_langs=ru%2Cko%2Cen%2Cpt%2Cde%2Cja%2Cit%2Cfr%2Cnl%2Ces&amp;hl=en-US&amp;expire=1475730347&amp;key=yttt1&amp;v=2QOx7vmjV2E&amp;caps=asr&amp;type=track&amp;lang=it&amp;name&amp;kind&amp;fmt=vtt\">`;\n    if(this.data.caption_tracks){\n      if(Array.isArray(this.data.caption_tracks.n)){\n        for(let i=0;i<this.data.caption_tracks.n.length;i++){\n          if(i===0){\n            let src = new Buffer(this.data.caption_tracks.u[i]+'&fmt=vtt&type=track').toString('base64');\n            v+= `<track label=\"${this.data.caption_tracks.n[i]}\" kind=\"subtitles\" srclang=\"${this.data.caption_tracks.lc[i]}\" src=\"/pipe?url=${src}\" default>`;\n          }else{\n            let src = new Buffer(this.data.caption_tracks.u[i]+'&fmt=vtt&type=track').toString('base64');\n            v+= `<track label=\"${this.data.caption_tracks.n[i]}\" kind=\"subtitles\" srclang=\"${this.data.caption_tracks.lc[i]}\" src=\"/pipe?url=${src}\">`;\n          }\n        }\n      }else{\n        let src = new Buffer(this.data.caption_tracks.u+'&fmt=vtt&type=track').toString('base64');\n        v+= `<track label=\"${this.data.caption_tracks.n}\" kind=\"subtitles\" srclang=\"${this.data.caption_tracks.lc}\" src=\"/pipe?url=${src}\" default>`;\n      }\n    }\n    v += `</video></body>\n  </html>`;\n    return v;\n  }\n}\n"]}